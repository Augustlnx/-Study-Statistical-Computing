"0","library(grid)"
"0","library(RColorBrewer)"
"0","library(SuppDists) #提供rJohnson()函数"
"0",""
"0","#为了画图方便，舍弃评分列缺少的行"
"0","data_game3 <- filter(data_game2, !is.na(`热度`))"
"0",""
"0","f2.data <- data_game3[c('类别','热度')]"
"0","colnames(f2.data) <- c(""类别"",""热度"")"
"0","table(f2.data$类别)"
"1","
"
"1","策略塔防 "
"1","动作游戏 "
"1","飞行游戏 "
"1","格斗游戏 "
"1","角色扮演 "
"1","竞速游戏 "
"1","冒险解谜 "
"1","模拟经营 "
"1","棋牌游戏 "
"1","射击游戏 "
"1","
"
"1","      90 "
"1","     136 "
"1","      37 "
"1","      28 "
"1","     114 "
"1","      85 "
"1","      86 "
"1","      53 "
"1","      18 "
"1","     110 "
"1","
"
"1","体育运动 "
"1","养成游戏 "
"1","益智休闲 "
"1","音乐游戏 "
"1","游戏工具 "
"1","
"
"1","      46 "
"1","      12 "
"1","     292 "
"1","      20 "
"1","      13 "
"1","
"
"0","# 定义颜色"
"0","mycol22 <- c(""#eb998b"", ""#fddbc8"", ""#42465c"", ""#356d67"", ""#4c9568"","
"0","             ""#7fb961"", ""#b0d45d"", ""#ffe788"", ""#b20000"", ""#f06152"","
"0","             ""#7d4444"", ""#9e6c69"", ""#cca69c"", ""#5066a1"", ""#76afda"","
"0","             ""#abddff"", ""#dcf2ff"", ""#e8743c"", ""#ffc556"")"
"0",""
"0","# 计算每个类别的均值和标准差"
"0","d <- group_by(f2.data, 类别) %>%"
"0","  summarize(mean = mean(热度),"
"0","            sd = sd(热度))"
"0",""
"0","# 创建图形"
"0","ggplot(f2.data, aes(类别, 热度, fill = 类别, color = 类别)) +"
"0","  geom_flat_violin(position = position_nudge(x = .2)) +"
"0","  geom_jitter(width = .1) +"
"0","  geom_pointrange(aes(y = mean, ymin = mean - sd, ymax = mean + sd),"
"0","                  data = d, size = 0.5, position = position_nudge(x = .2),color = 'red') +"
"0","  scale_fill_manual(values = mycol22) +  # 设置填充颜色"
"0","  scale_color_manual(values = mycol22) +  # 设置点的颜色"
"0","  theme_bw() +"
"0","  theme(axis.text.x = element_text(size = 13, angle = 90, hjust = 1),  # 设置x轴标签垂直"
"0","        axis.text.y = element_text(size = 13),"
"0","        axis.title = element_text(size = 15),"
"0","        legend.position = ""none"")"
