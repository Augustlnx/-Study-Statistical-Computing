"0","# 对训练集进行预测并计算各项指标"
"0","predicted_train <- predict(lgb, train_matrix)"
"2","Warning: 强制改变过程中产生了NA"
"0","train_rmse <- rmse(y_train, predicted_train)"
"0","train_mse <- mean((predicted_train - y_train)^2)"
"0","sst_train <- sum((y_train - mean(y_train))^2)"
"0","sse_train <- sum((y_train - predicted_train)^2)"
"0","r_squared_train <- 1 - sse_train / sst_train"
"0",""
"0","# # 打印训练集结果"
"0","# print(paste(""训练集 RMSE:"", train_rmse))"
"0","# print(paste(""训练集 MSE:"", train_mse))"
"0","# print(paste(""训练集 R²:"", r_squared_train))"
"0",""
"0","# 对测试集进行预测并计算各项指标"
"0","predicted_test <- predict(lgb, test_matrix)"
"2","Warning: 强制改变过程中产生了NA"
"0","test_rmse <- rmse(y_test, predicted_test)"
"0","test_mse <- mean((predicted_test - y_test)^2)"
"0","sst_test <- sum((y_test - mean(y_test))^2)"
"0","sse_test <- sum((y_test - predicted_test)^2)"
"0","r_squared_test <- 1 - sse_test / sst_test"
"0","# "
"0","# # 打印测试集结果"
"0","# print(paste(""测试集 RMSE:"", test_rmse))"
"0","# print(paste(""测试集 MSE:"", test_mse))"
"0","# print(paste(""测试集 R²:"", r_squared_test))"
"0",""
"0","# 创建数据框"
"0","lgb_model_eval <- data.frame("
"0","  model = rep(""LGB"", 2),"
"0","  mse = c(train_mse, test_mse),"
"0","  rmse = c(train_rmse, test_rmse),"
"0","  R2 = c(r_squared_train, r_squared_test),"
"0","  dataset = factor(c(""train"", ""test""))"
"0",")"
"0",""
"0","# 打印结果"
"0","print(lgb_model_eval)"
